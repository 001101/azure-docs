---
title: Support for Hyper-V discovery in Azure Migrate
description: Learn about support for Hyper-V discovery with Azure Migrate Server Assessment
ms.topic: conceptual
ms.date: 07/20/2020
---

# Support requirements for Hyper-V discovery

This article summarizes prerequisites and support requirements when you discover on-premises VMware VMs using the [Azure Migrate:Server Assessment](migrate-services-overview.md#azure-migrate-server-assessment-tool) tool. 


You can also review:

[General support requirements](migrate-support-matrix.md) for Azure Migrate.
Support requirements for assessment with the Azure Migrate:Server Assessment tool.


## Limitations

**Support** | **Details****Assessment limits** | You can discover and assess up to 35,000 Hyper-V VMs in a single [Azure Migrate project](migrate-support-matrix.md#azure-migrate-projects).
--- | ---
**Project limits** | You can discover and assess up to 35,000 Hyper-V VMs in a single [Azure Migrate project](migrate-support-matrix.md#azure-migrate-projects).
**Appliance limits** | An Azure Migrate appliance can discover up to 5000 Hyper-V VMs.<br/><br/> The appliance can connect to up to 300 Hyper-V hosts.

## Hyper-V host requirements

| **Support**                | **Details**               
| :-------------------       | :------------------- |
| **Hyper-V host**       | The Hyper-V host can be standalone, or deployed in a cluster.<br/><br/> The Hyper-V host can run Windows Server 2019, Windows Server 2016, or Windows Server 2012 R2.<br/> You can't assess VMs located on Hyper-V hosts running Windows Server 2012.
| **Permissions**           | To discover VMs, you need Administrator permissions on the Hyper-V host. <br/> If you don't want to assign Administrator permissions, you can add a local admin or domain user account to these groups- Remote Management Users, Hyper-V Administrators, and Performance Monitor Users. |
| **PowerShell remoting**   | [PowerShell remoting](/powershell/module/microsoft.powershell.core/enable-psremoting?view=powershell-7) must be enabled on each Hyper-V host. |
| **Hyper-V Replica**       | If you use Hyper-V Replica (or you have multiple VMs with the same VM identifiers) on the host, and you discover both the original and replicated VMs using Azure Migrate, assessments generated by Azure Migrate might not be accurate. |
| **Hyper-V host ports**       | Hosts need an inbound connection on WinRM port 5985 (HTTP) to pull metadata and performance data for Hyper-V VMs using a Common Information Model (CIM) session.


## VM requirements

| **Support**                  | **Details**               
| :----------------------------- | :------------------- |
| **Hyper-V VMs** | Server Assessment can discover Hyper-V VMs running any operating system.  |



## Azure Migrate appliance requirements

Azure Migrate uses the [Azure Migrate appliance](migrate-appliance.md) for discovery and assessment. 

**Requirement** | **Details**
--- | ---
Deployment requirements	| Learn about [appliance requirements](migrate-appliance.md#appliance---hyper-v) for Hyper-V.
Deployment options | You can deploy the appliance as a Hyper-V VMs that you create using a compressed Hyper-V VHD downloaded from the portal, or using a [PowerShell script](deploy-appliance-script.md).<br/><br/> In Azure Government, you must deploy the appliance using the script.<br/><br/> Review the [appliance architecture](migrate-appliance-architecture.md), and [detailed deployment information](migrate-appliance.md).
URL access	| Review the URLs that the appliance needs to access in [public](migrate-appliance.md#public-cloud-urls) and [government](migrate-appliance.md#government-cloud-urls) clouds.
Ports |	The appliance machine should allow:<br/><br/> - Inbound connections on TCP port 3389, to allow remote desktop connections to the appliance.<br/><br/> - Inbound connections on port 44368 to remotely access the appliance management app using the URL: https://<appliance-ip-or-name>:44368.<br/><br/> - Outbound connections on port 443 (HTTPS), to send discovery and performance metadata to Azure Migrate.

## Agent-based dependency analysis requirements

You can discover dependencies on VMs using [agent-based dependency mapping](concepts-dependency-visualization.md). Aegntless mapping isn't currently supported for Hyper-V VMs. The table summarizes the requirements for setting up agent-based dependency analysis.

**Requirement** | **Details** 
--- | --- 
**Agents** | On each machine you want to analyze, you need these agents:<br/><br/> The [Microsoft Monitoring agent (MMA)](../azure-monitor/platform/agent-windows.md).<br/> The [Dependency agent](../azure-monitor/platform/agents-overview.md#dependency-agent).<br/><br/> If on-premises machines aren't connected to the internet, you need to download and install Log Analytics gateway on them.<br/><br/> Learn more about installing the [Dependency agent](how-to-create-group-machine-dependencies.md#install-the-dependency-agent) and [MMA](how-to-create-group-machine-dependencies.md#install-the-mma).
**Log Analytics workspace** | Azure Migrate uses the [Service Map](../azure-monitor/insights/service-map.md) solution in [Azure Monitor logs](../azure-monitor/log-query/log-query-overview.md) for dependency visualization.<br/><br/> You associate a new or existing Log Analytics workspace with an Azure Migrate project.The workspace associated with Azure Migrate is tagged with the Migration Project key, and the project name.<br/><br/> The workspace must be in the same subscription as the Azure Migrate project.<br/><br/> Azure Migrate supports workspaces residing in the East US, Southeast Asia, and West Europe regions. Workspaces in other regions can't be associated with a Migrate project.<br/><br/> The workspace must be in a region in which [Service Map is supported](../azure-monitor/insights/vminsights-enable-overview.md#prerequisites).<br/><br/> The workspace for an Azure Migrate project can't be modified after it's added. 
**VM support** | Supported for all machines.
**Azure Government** | Dependency visualization isn't available in Azure Government.
**Costs** | The Service Map solution doesn't incur any charges for the first 180 days (from the day that you associate the Log Analytics workspace with the Azure Migrate project)/<br/><br/> After 180 days, standard Log Analytics charges will apply.<br/><br/> Using any solution other than Service Map in the associated Log Analytics workspace will incur [standard charges](https://azure.microsoft.com/pricing/details/log-analytics/) for Log Analytics.<br/><br/> When the Azure Migrate project is deleted, the workspace is not deleted along with it. After deleting the project, Service Map usage isn't free, and each node will be charged as per the paid tier of Log Analytics workspace/<br/><br/>If you have projects that you created before Azure Migrate general availability (GA- 28 February 2018), you might have incurred additional Service Map charges. To ensure payment after 180 days only, we recommend that you create a new project, since existing workspaces before GA are still chargeable.
**Management** | When you register agents to the workspace, you use the ID and key provided by the Azure Migrate project.<br/><br/> You can use the Log Analytics workspace outside Azure Migrate.<br/><br/> If you delete the associated Azure Migrate project, the workspace isn't deleted automatically. [Delete it manually](../azure-monitor/platform/manage-access.md).<br/><br/> Don't delete the workspace created by Azure Migrate, unless you delete the Azure Migrate project. If you do, the dependency visualization functionality will not work as expected.
**Internet connectivity** | If machines aren't connected to the internet, you need to install the Log Analytics gateway on them.


## Next steps

Discover Hyper-V VMs.
