---
# Mandatory fields.
title: Routing events
description: Understand how to route events from Azure Digital Twins to other Azure Services.
author: baanders
ms.author: baanders # Microsoft employees only
ms.date: 2/21/2020
ms.topic: conceptual
ms.service: digital-twins

# Optional fields. Don't forget to remove # if you need a field.
# ms.custom: can-be-multiple-comma-separated
# ms.reviewer: MSFT-alias-of-reviewer
# manager: MSFT-alias-of-manager-or-PM-counterpart
---

# Event Routes: Egressing Data to External Services (Private Preview, Public Preview)

Often, data from ADT needs to be sent to downstream data services. For example, in this example we might want to send the data to a TSI instance to record time series data of handwash-related events for bulk analytics.

Data egress is handled using **event routes**. An event route lets you send event data, such as telemetry events, life cycle events and property change events from twins to defined endpoints in your subscriptions, such as an Event Hub, an Event Grid or a Service Bus. 

In addition to T2T event handlers, ADT can also send telemetry and notifications to external endpoints by using Event Routes.
ADT will emit the following events (notifications and telemetry messages) and they will be routed to custom endpoints:
* Digital Twin change notification
* Digital Twin lifecycle notification
* Digital Twin edge Change notification
* Digital Twin model Change notification (public preview)
* Digital Twins subscription change notification (public preview)
* Digital Twin telemetry messages

ADT will route all events defined above to custom endpoints.

![ADT routing workflow](./media/concepts-events/routing-workflow.png)

## Creating Event routes

Event Routes are used to send data to external resources. The typical use case for event routes is to send data to external downstream resources. Unlike event handlers, that are setup with very specific context, event routes typically are broad in scope and deliver data without regard for specific context. 
 
Event Routes are created with a very simple interface:
`Response RegisterEventRoute(string routeId, string endpointId, string topic, string filter);`
The endpointId must identify an endpoint, such as an EventHub, EventGrid or ServiceBus that has been created in your subscription and attached to ADT beforehand using ADT control plane APIs

> [!NOTE]
> Add example how to attach an endpoint using the control plane API 

If a topic is specified and the registered endpoint supports topics, the topic field is used to send the message to the specified topic. 
By default, an event route accepts and routes every single message generated by the system. The filter parameter allows you to selectively route messages based on event types (e.g. telemetry events, twin property change events, life cycle events, etc.), twin type and other parameters. This allows for the creation of selective routes. 

It is absolutely possible to access ADT resources from compute resources connected to event routes. However, unlike event handler subscriptions, events sent via routes come without context. That is, a compute resource that wants to modify the ADT graph in response to an event passed via an event route has to either know the twin it wants to modify in advance, or use a query or navigation through the graph to find the appropriate target. It also is needs to establish security and access independently. As a result, it is typically easier to modify twins using event handler functions.

On the other hand, event routes excel for sending bulk event data from ADT to downstream resources such as TSI, storage and analytics solutions.
