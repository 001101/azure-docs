---
title: Secure access for Azure Logic Apps
description: Add security to triggers, inputs and outputs, parameters, and connections to other services in Azure Logic Apps
services: logic-apps
ms.service: logic-apps
ms.suite: integration
author: kevinlam1
ms.author: klam
ms.reviewer: estfan, LADocs
ms.topic: article
ms.date: 06/28/2019
---

# Secure access in Azure Logic Apps

Here are the areas where you can secure access for your logic apps:

* [HTTP request triggers](#secure-triggers)
* [Operations that view, manage, or edit logic apps](#secure-operations)
* [Run history inputs and outputs](#secure-run-history)
* [Action parameters and inputs](#secure-action-parameters)
* [Services that get requests from your logic app](#secure-requests)

<a name="secure-triggers"></a>

## Access to HTTP request triggers

When your logic app uses an HTTP request-based trigger, such as the [Request](../connectors/connectors-native-reqres.md) or [Webhook](../connectors/connectors-native-webhook.md) trigger, you can restrict access so that only authorized clients can start your logic app. All requests received by a logic app are encrypted and secured with Secure Sockets Layer (SSL) protocol. Here are the different ways that you can secure access to this trigger type:

* [Generate shared access signatures](#sas)
* [Restrict incoming IP addresses](#restrict-incoming-ip-addresses)
* [Add Azure Active Directory, OAuth, or other security](#add-authentication)

<a name="sas"></a>

### Generate shared access signatures

Every request endpoint on a logic app includes a [Shared Access Signature (SAS)](../storage/common/storage-dotnet-shared-access-signature-part-1.md) in the endpoint's URL. Each URL contains an `sp`, `sv`, and `sig` query parameter:

| Query parameter | Description |
|-----------------|-------------|
| `sp` | Specifies permissions for the permitted HTTP methods to use. |
| `sv` | Specifies the version to use for generating the signature. |
| `sig` | For authenticating access to the trigger |
|||

The signature is generated by using the SHA256 algorithm with a secret access key on all the URL paths and properties. The secret key is never exposed or published, and is kept encrypted and stored with the logic app. Your logic app authorizes only those triggers that contain a valid signature created with the secret key.

For more information about securing access with Shared Access Signature, see these sections in this topic:

* [Regenerate access keys](#access-keys)
* [Create expiring callback URLs](#expiring-urls)
* [Create URLs with primary or secondary key](#primary-secondary-key)

<a name="access-keys"></a>

#### Regenerate access keys

To regenerate a new secure access key at any time, use the Azure REST API or Azure portal. All previously generated URLs that use the old key are invalidated and no longer have authorization to trigger the logic app. The URLs that you retrieve after regeneration are signed with the new access key.

1. In the Azure portal, open the logic app that has the key you want to regenerate.

1. On the logic app's menu, under **Settings**, select **Access Keys**.

1. Select the key you want to regenerate and complete the process.

<a name="expiring-urls"></a>

#### Create callback URLs with expiration dates

If you share the endpoint URL for an HTTP request-based trigger with other parties, you can generate callback URLs that use specific keys and have expiration dates. That way, you can seamlessly roll keys or restrict access to triggering your logic app based on a specific timespan. To specify an expiration date for a URL, use the [Logic Apps REST API](https://docs.microsoft.com/rest/api/logic/workflowtriggers), for example:

``` http
POST /subscriptions/<Azure-subscription-ID>/resourceGroups/<Azure-resource-group-name>/providers/Microsoft.Logic/workflows/<workflow-name>/triggers/<trigger-name>/listCallbackUrl?api-version=2016-06-01
```

In the body, include the `NotAfter`property by using a JSON date string. This property returns a callback URL that's valid only until the `NotAfter` date and time.

<a name="primary-secondary-key"></a>

#### Create URLs with primary or secondary secret key

When you generate or list callback URLs for HTTP request-based triggers, you can specify the key to use for signing the URL. To generate a URL that's signed by a specific key, use the [Logic Apps REST API](https://docs.microsoft.com/rest/api/logic/workflowtriggers), for example:

``` http
POST /subscriptions/<Azure-subscription-ID>/resourceGroups/<Azure-resource-group-name>/providers/Microsoft.Logic/workflows/<workflow-name>/triggers/<trigger-name>/listCallbackUrl?api-version=2016-06-01
```

In the body, include the `KeyType` property as either `Primary` or `Secondary`. This property returns a URL that's signed by the specified secure key.

<a name="restrict-incoming-ip"></a>

### Restrict incoming IP addresses

Along with Shared Access Signature, you might want to limit the specific clients that can call your logic app.  
For example, if you manage your request endpoint by using Azure API Management, you can restrict your logic app to accept requests only from the IP address for the API Management instance.

#### Set IP ranges in Azure portal

To set up this restriction in the Azure portal, go to your logic app's settings.

1. In the Azure portal, open your logic app in the Logic App Designer.

1. On your logic app's menu, under **Settings**, select **Workflow settings**.

1. Under **Access control configuration** > **Allowed inbound IP addresses**, select **Specific IP ranges**.

1. Under **IP ranges for triggers**, specify the IP address ranges that the trigger accepts. A valid IP range uses these formats: *x.x.x.x/x* or *x.x.x.x-x.x.x.x*

If you want your logic app to fire only as a nested logic app, from the **Allowed inbound IP addresses** list, select **Only other Logic Apps**. This option writes an empty array to your logic app resource. That way, only only calls from the Logic Apps service (parent logic apps) can trigger the nested logic app.

> [!NOTE]
> Regardless of IP address, you can still run a logic app that has an HTTP request-based trigger 
> by using `/triggers/<trigger-name>/run` through the Azure REST API or through API Management. 
> However, > this scenario still requires authentication against the Azure REST API. 
> All events appear in the Azure Audit Log. Make sure you set access control policies accordingly.

#### Set IP ranges in logic app template

If you're automating logic app deployments by using an [Azure Resource Manager template](../logic-apps/logic-apps-create-deploy-template.md), you can set the IP ranges in that template, for example:

``` json
{
   "properties": {
      "definition": {},
      "parameters": {},
      "accessControl": {
         "triggers": {
            "allowedCallerIpAddresses": [
               {
                  "addressRange": "192.168.12.0/23"
               },
               {
                  "addressRange": "2001:0db8::/64"
               }
            ]
         }
      }
   },
   "type": "Microsoft.Logic/workflows",
}
```

<a name="add-authentication"></a>

### Add Azure Active Directory, OAuth, or other security

To add more authorization protocols to your logic app, consider using [Azure API Management](https://azure.microsoft.com/services/api-management/). This service gives you the capability to expose your logic app as an API and offers rich monitoring, security, policy, and documentation for any endpoint. API Management can expose a public or private endpoint for your logic app, which can then use Azure Active Directory, OAuth, certificate, or other security standards. When API Management receives a request, the service sends the request to your logic app, also making any necessary transformations or restrictions along the way. To let only API Management trigger your logic app, you can use your logic app's incoming IP range settings.

<a name="secure-operations"></a>

## Secure access to logic app operations

To permit only specific users or groups that can run operations, such as managing, editing, and viewing logic apps, you can restrict by using [Azure Role-Based Access Control (RBAC)](../role-based-access-control/role-assignments-portal.md). You can assign customized or built-in roles to members in your Azure subscription, for example:

* [Logic App Contributor](../role-based-access-control/built-in-roles.md#logic-app-contributor): Lets you manage logic apps, but you can't change access to them.

* [Logic App Operator](../role-based-access-control/built-in-roles.md#logic-app-operator): Lets you read, enable, and disable logic apps, but you can't edit or update them.

To prevent others from changing or deleting your logic app, you can use [Azure Resource Lock](../azure-resource-manager/resource-group-lock-resources.md), which prevents others from changing or deleting production resources.

<a name="secure-run-history"></a>

## Secure access to run history

All data during a logic app's run is encrypted during transit and at rest. When your logic app finishes running, you can view the history for that run, including the steps that ran along with the status, duration, inputs, and outputs for each action. This rich detail provides insight into how your logic app ran and where you might start troubleshooting any problems that arise.

When you access your logic app's run history, Logic Apps authenticates your access and provides links to the inputs and outputs from the requests and responses in your logic app's run. However, for actions that handle any secrets or sensitive information, you want to prevent others from viewing and accessing that data. For example, if your logic app gets a secret from [Azure Key Vault](../key-vault/key-vault-whatis.md) to use when authenticate an HTTP action, you want to hide that secret from view.

To control access to the inputs and outputs in your logic app's run history, you have these options:

* [Restrict access to specific IP address ranges](#restrict-ip).

  This option lets you secure access to run history based on the requests from a specific IP address range.

* [Secure inputs and outputs by using obfuscation](#obfuscate).

  This option lets you hide inputs and outputs based on the trigger or action. Here are some considerations when using obfuscation:

  * When you secure the outputs from a trigger or action, Logic Apps also blocks the inputs history for any actions that explicitly reference those outputs. Also, if actions use secured outputs as inputs, those inputs are secured only if the actions produce the same data as the inputs. Make sure that you secure the outputs from those actions.

  * When you secure an action's inputs or outputs, you prevent that action from sending the that secured data to Azure Log Analytics. You also can't add [tracked properties](logic-apps-monitor-your-logic-apps.md#azure-diagnostics-event-settings-and-details) to that action for monitoring.

  * The [Logic Apps API for handling workflow history](https://docs.microsoft.com/rest/api/logic/) doesn't return secured outputs.

<a name="restrict-ip"></a>

### Restrict access by IP range

You can limit access to the inputs and outputs in your logic app's run history so that only requests from specific IP address ranges can view that data. For example, to block anyone from accessing inputs and outputs, you can specify an IP address range such as
`0.0.0.0-0.0.0.0` . Only a person with administrator permissions can remove this restriction, which provides the possibility for "just-in-time" access to your logic app's data.

You can limit access to IP ranges either by using the Azure portal or by using an Azure Resource Manager template that you use for logic app deployment.

### Restrict IP ranges in the Azure portal

1. In the Azure portal, open your logic app in the Logic App Designer.

1. On your logic app's menu, under **Settings**, select **Workflow settings**.

1. Under **Access control configuration** > **Allowed inbound IP addresses**, select **Specific IP ranges**.

1. Under **IP ranges for contents**, specify the IP address ranges that can access content from inputs and outputs. A valid IP range uses these formats: *x.x.x.x/x* or *x.x.x.x-x.x.x.x*

### Restrict IP ranges in logic app template

If you automate logic app deployment by using a [Azure Resource Manager template](../logic-apps/logic-apps-create-deploy-template.md), you can specific the IP ranges in that template by using the `accessControl` object, for example:

``` json
{
   "properties": {
      "definition": {},
      "parameters": {},
      "accessControl": {
         "contents": {
            "allowedCallerIpAddresses": [
               {
                  "addressRange": "192.168.12.0/23"
               },
               {
                  "addressRange": "2001:0db8::/64"
               }
            ]
         }
      }
   },
   "type": "Microsoft.Logic/workflows",
}
```

<a name="obfuscate"></a>

### Secure access by obfuscation

1. If your logic app isn't already open in the [Azure portal](https://portal.azure.com), open your logic app in the Logic App Designer.

   ![Open sample logic app](media/logic-apps-obfuscate-inputs-outputs/sample-logic-app.png)

1. On the trigger or action where you want to secure data, select the ellipses (**...**) button, and then select **Settings**.

   ![Open "Settings"](media/logic-apps-obfuscate-inputs-outputs/open-settings.png)

1. Turn on either **Secure inputs**, **Secure outputs**, or both. When you're finished, select **Done**.

   ![Turn on secure inputs or outputs](media/logic-apps-obfuscate-inputs-outputs/turn-on-secure-inputs-outputs.png)

   The action or trigger now shows a lock icon in the title bar.

   ![Lock icon on title bar](media/logic-apps-obfuscate-inputs-outputs/title-bar-lock-icon.png)

   Tokens that represent secured outputs from previous actions also show lock icons. For example, when you select such an output from the dynamic content list to use in an action, that token shows a lock icon.

   ![Select output](media/logic-apps-obfuscate-inputs-outputs/select-secured-token.png)

1. After the logic app runs, you can view the history for that run.

   1. On the logic app's **Overview** pane, select the run that you want to view.

   1. On the **Logic app run** pane, expand the actions that you want to review.

      Secured inputs and outputs are hidden from view.

      ![Hidden data in run history](media/logic-apps-obfuscate-inputs-outputs/hidden-data-run-history.png)

<a name="secure-action-parameters"></a>

## Secure action parameters and inputs

If you deploy across various environments, you might want to parameterize specific elements in your logic app's workflow definition. That way, you can provide inputs based on your environments and protect sensitive information. For example, if you authenticate HTTP actions with [Azure Active Directory](../logic-apps/logic-apps-workflow-actions-triggers.md#connector-authentication), you can define and secure the parameters that accept the client ID and client secret used for authentication. For these parameters, your logic app's workflow definition has its own `parameters` section.
To access parameter values during runtime, you can use the `@parameters('<parameter-name>')` expression, which is provided by the [Workflow Definition Language](https://aka.ms/logicappsdocs).

To protect parameters and values you don't want shown when editing your logic app or viewing run history, you can define parameters with the `securestring` type and use encoding as necessary. Parameters that have this type aren't returned with the resource definition and aren't accessible when viewing the resource after deployment.

> [!NOTE]
> If you use a parameter in a request's headers or body, 
> that parameter might be visible when accessing your 
> logic app's run history and outgoing HTTP request. 
> Make sure you also set your content access policies accordingly.
> Authorization headers are never visible through inputs or outputs. 
> So if a secret is used there, that secret isn't retrievable.

For more information, see [Secure parameters in workflow definitions](#secure-parameters-workflow) later in this topic.

If you automate deployments with [Azure Resource Manager templates](../azure-resource-manager/resource-group-authoring-templates.md#parameters), you can also use secured template parameters, which are evaluated at deployment. Your template definition has its own `parameters` section that's separate from your workflow definition's `parameters` section. To provide the values for template parameters, you can use a separate [parameter file](../azure-resource-manager/resource-group-template-deploy.md#pass-parameter-values).

For example, if you use secrets, you can define and use secured template parameters that retrieve those secrets from [Azure Key Vault](../key-vault/key-vault-whatis.md) at deployment. You can then reference the key vault and secret in your parameter file. For more information, see these topics:

* [Use Azure Key Vault to pass secure parameter values at deployment](../azure-resource-manager/resource-manager-keyvault-parameter.md)

* [Secure parameters in logic app templates](#secure-parameters-deployment-template) later in this topic

<a name="secure-parameters-workflow"></a>

### Secure parameters in workflow definitions

To protect sensitive information in your logic app's workflow definition, use secured parameters so this information isn't visible after you save your logic app. For example, suppose you have an HTTP action requires basic authentication, which uses a username and password. In the workflow definition, the `parameters` section defines the `passwordParam` and `usernameParam` parameters by using the `securestring` type. The action definition then references these parameters in the `authentication` section.

```json
"definition": {
   "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
   "actions": {
      "HTTP": {
         "type": "Http",
         "inputs": {
            "method": "GET",
            "uri": "https://www.microsoft.com",
            "authentication": {
               "type": "Basic",
               "username": "@parameters('usernameParam')",
               "password": "@parameters('passwordParam')"
            }
         },
         "runAfter": {}
      }
   },
   "parameters": {
      "passwordParam": {
         "type": "securestring"
      },
      "usernameParam": {
         "type": "securestring"
      }
   },
   "triggers": {
      "manual": {
         "type": "Request",
         "kind": "Http",
         "inputs": {
            "schema": {}
         }
      }
   },
   "contentVersion": "1.0.0.0",
   "outputs": {}
}
```

<a name="secure-parameters-deployment-template"></a>

### Secure parameters in Azure Resource Manager templates

A Resource Manager template that includes a workflow definition includes more than one `parameters` sections:

* At the template level, the top-level `parameters` section defines the parameters that accept the values to use at deployment, such as the connection strings to use for various deployment environments.

  To specify the environment values for template parameters, you can use a separate [parameter file](../azure-resource-manager/resource-group-template-deploy.md#pass-parameter-values). If you use secrets, you can define and use secured template parameters that retrieve those secrets from [Azure Key Vault](../key-vault/key-vault-whatis.md) at deployment. You can then reference the key vault and secret in your [parameter file](../azure-resource-manager/resource-group-template-deploy.md#pass-parameter-values). For more information, see [Use Azure Key Vault to pass secure parameter values at deployment](../azure-resource-manager/resource-manager-keyvault-parameter.md).

* In your logic app's resource definition, but outside your workflow definition, the `parameters` section specifies the values used by the parameters in your workflow definition by referencing your template's parameters.

* Inside your workflow definition, the innermost `parameters` section defines the parameters that accept the values to use at your logic app's runtime.

This example shows a template that defines more than one secured parameter, which uses the `securestring` type:

| Parameter name | Description |
|----------------|-------------|
| `TemplatePasswordParam` | A template parameter that accepts a password that's passed to the the workflow definition's `logicAppWfParam` parameter |
| `logicAppWfParam` | A workflow definition parameter that accepts input for the HTTP action that uses basic authentication |
|||

```json
{
   "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
   "contentVersion": "1.0.0.0",
   "parameters": {
      "LogicAppName": {
         "type": "string",
         "minLength": 1,
         "maxLength": 80,
         "metadata": {
            "description": "Name of the Logic App."
         }
      },
      "TemplatePasswordParam": {
         "type": "securestring"
      },
      "LogicAppLocation": {
         "type": "string",
         "defaultValue": "[resourceGroup().location]",
         "allowedValues": [
            "[resourceGroup().location]",
            "eastasia",
            "southeastasia",
            "centralus",
            "eastus",
            "eastus2",
            "westus",
            "northcentralus",
            "southcentralus",
            "northeurope",
            "westeurope",
            "japanwest",
            "japaneast",
            "brazilsouth",
            "australiaeast",
            "australiasoutheast",
            "southindia",
            "centralindia",
            "westindia",
            "canadacentral",
            "canadaeast",
            "uksouth",
            "ukwest",
            "westcentralus",
            "westus2"
         ],
         "metadata": {
            "description": "Location of the Logic App."
         }
      }
   },
   "variables": {},
   "resources": [
      {
         "name": "[parameters('LogicAppName')]",
         "type": "Microsoft.Logic/workflows",
         "location": "[parameters('LogicAppLocation')]",
         "tags": {
            "displayName": "LogicApp"
         },
         "apiVersion": "2016-06-01",
         "properties": {
            "definition": {
               "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-0601/workflowdefinition.json#",
               "actions": {
                  "HTTP": {
                     "type": "Http",
                     "inputs": {
                        "method": "GET",
                        "uri": "https://www.microsoft.com",
                        "authentication": {
                           "type": "Basic",
                           "username": "@parameters('usernameParam')",
                           "password": "@parameters('logicAppWfParam')"
                        }
                     },
                  "runAfter": {}
                  }
               },
               "parameters": {
                  "logicAppWfParam": {
                     "type": "securestring"
                  },
                  "usernameParam": {
                     "type": "securestring"
                  }
               },
               "triggers": {
                  "manual": {
                     "type": "Request",
                     "kind": "Http",
                     "inputs": {
                        "schema": {}
                     }
                  }
               },
               "contentVersion": "1.0.0.0",
               "outputs": {}
            },
            "parameters": {
               "logicAppWfParam": {
                  "value": "[parameters('TemplatePasswordParam')]"
               }
            }
         }
      }
   ],
   "outputs": {}
}
```

<a name="secure-requests"></a>

## Secure access to services called from logic apps

Here are some ways that you can secure any endpoint where your logic app sends requests and needs access.

* Add authentication on outbound requests.

  When you work with an HTTP, HTTP + Swagger (Open API), or Webhook action, you can add authentication to the request sent by your logic app. For example, you can use basic authentication, certificate authentication, or Azure Active Directory authentication. For more information, see [Authenticate triggers or actions](../logic-apps/logic-apps-workflow-actions-triggers.md#connector-authentication).

* Restrict access from logic app IP addresses.

  All calls from logic apps to endpoints originate from specific designated IP addresses that are based on the logic apps' regions. You can add filtering that accepts requests only from those IP addresses. To get these IP addresses, see [Limits and configuration for Azure Logic Apps](logic-apps-limits-and-config.md#configuration).

* Secure connections to on-premises systems.

  Azure Logic Apps provides integration with these services for secure and reliable on-premises communication.

  * On-premises data gateway

    Many managed connectors in Azure Logic Apps provide secure connections to on-premises systems, such as File System, SQL, SharePoint, and DB2. The gateway sends data from on-premises sources on encrypted channels through the Azure Service Bus. All traffic originates as secure outbound traffic from the gateway agent. Learn [how the on-premises data gateway works](logic-apps-gateway-install.md#gateway-cloud-service).

  * Connect through Azure API Management

    [Azure API Management](https://azure.microsoft.com/services/api-management/) provides on-premises connection options, such as site-to-site virtual private network and ExpressRoute integration for secured proxy and communication to on-premises systems. From your logic app's workflow in the Logic App Designer, you can select an API that's exposed by API Management, which provides quick access to on-premises systems.

## Next steps

* [Create a deployment template](logic-apps-create-deploy-template.md)  
* [Exception handling](logic-apps-exception-handling.md)  
* [Monitor your logic apps](logic-apps-monitor-your-logic-apps.md)  
* [Diagnose logic app failures and issues](logic-apps-diagnosing-failures.md)  
