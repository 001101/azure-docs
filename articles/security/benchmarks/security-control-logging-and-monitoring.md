---
title: Security Control - Logging and Monitoring
description: Security Control Logging and Monitoring
author: msmbaldwin
manager: rkarlin

ms.service: security
ms.topic: conceptual
ms.date: 12/17/2019
ms.author: mbaldwin
ms.custom: security-recommendations

---

# Security Control: Logging and Monitoring

Security logging recommendations focus on activities related to enabling, acquiring, and storing audit logs for Azure services.

The following sections list the recommendations for Logging and Monitoring.

## 2.1: Use Approved Time Synchronization resource

| Azure ID | CIS IDs | Responsibility |
|--|--|--|
| 2.1 | 6.1 | Microsoft |

Microsoft maintains time sources for Azure resources, customers may update time synchronization for compute deployments owned by customer.

How to configure time synchronization for Azure compute resources:
https://docs.microsoft.com/azure/virtual-machines/windows/time-sync

## 2.2: Configure Central Security Log Management

| Azure ID | CIS IDs | Responsibility |
|--|--|--|
| 2.2 | 6.5, 6.6 | Customer |

Ingest logs via Azure Monitor to aggregate security data generated by endpoints devices, network resources, and other security systems. Within Azure Monitor, use Log Analytics Workspace(s) to query and perform analytics, and use Azure Storage Accounts for long-term/archival storage.

How to collect platform logs and metrics with Azure Monitor:
https://docs.microsoft.com/azure/azure-monitor/platform/diagnostic-settings

How to collect Azure Virtual Machine internal host logs with Azure Monitor:
https://docs.microsoft.com/azure/azure-monitor/learn/quick-collect-azurevm

## 2.3: Enable audit logging for Azure Resources

| Azure ID | CIS IDs | Responsibility |
|--|--|--|
| 2.3 | 6.2, 6.3 | Customer |

Enable Diagnostic Settings for Azure Resource Logs for access to audit, security, and diagnostic logs. Activity logs which includes event source, date, user, timestamp, source addresses, destination addresses, and other useful elements.

How to collect platform logs and metrics with Azure Monitor:
https://docs.microsoft.com/azure/azure-monitor/platform/diagnostic-settings

Understanding logging and different log types in Azure:
https://docs.microsoft.com/azure/azure-monitor/platform/platform-logs-overview

## 2.4: Collect Security Logs from Operating Systems

| Azure ID | CIS IDs | Responsibility |
|--|--|--|
| 2.4 | 6.2, 6.3 | Customer |

If the compute resource is owned by Microsoft, then Microsoft is responsible for monitoring it. If the compute resource is owned by your organization, it's your responsibility to monitor it. You can use Azure Security Center to monitor the OS. Data collected by Security Center from the operating system includes OS type and version, OS (Windows event logs), running processes, machine name, IP addresses, and logged in user. The Log Analytics Agent also collects crash dump files.

How to collect Azure Virtual Machine internal host logs with Azure Monitor:
https://docs.microsoft.com/azure/azure-monitor/learn/quick-collect-azurevm

Understanding Azure Security Center data collection:
https://docs.microsoft.com/azure/security-center/security-center-enable-data-collection

## 2.5: Configure Security Log Storage Retention

| Azure ID | CIS IDs | Responsibility |
|--|--|--|
| 2.5 | 6.4 | Customer |

Within Azure Monitor, set your Log Analytics Workspace retention period according to your organization's compliance regulations. Use Azure Storage Accounts for long-term/archival storage.

How to set log retention parameters for Log Analytics Workspaces:
https://docs.microsoft.com/azure/azure-monitor/platform/manage-cost-storage#change-the-data-retention-period

## 2.6: Monitor and Review Logs

| Azure ID | CIS IDs | Responsibility |
|--|--|--|
| 2.6 | 6.7 | Customer |

Analyze and monitor logs for anomalous behavior and regularly review results. Use Azure Monitor's Log Analytics Workspace to review logs and perform queries on log data.

Understanding Log Analytics Workspace:
https://docs.microsoft.com/azure/azure-monitor/log-query/get-started-portal

How to perform custom queries in Azure Monitor:
https://docs.microsoft.com/azure/azure-monitor/log-query/get-started-queries

## 2.7: Enable Alerts for Anomalous Activity

| Azure ID | CIS IDs | Responsibility |
|--|--|--|
| 2.7 | 6.8 | Customer |

Use Azure Security Center with Log Analytics Workspace for monitoring and alerting on anomalous activity found in security logs and events.

How to manage alerts in Azure Security Center:
https://docs.microsoft.com/azure/security-center/security-center-managing-and-responding-alerts

How to alert on log analytics log data:
https://docs.microsoft.com/azure/azure-monitor/learn/tutorial-response

## 2.8: Centralize Anti-malware Logging

| Azure ID | CIS IDs | Responsibility |
|--|--|--|
| 2.8 | 8.6 | Customer |

Enable antimalware event collection for a Azure Virtual Machines and Cloud Services.

How to configure Microsoft Antimalware for Virtual Machines:
https://docs.microsoft.com/powershell/module/servicemanagement/azure/set-azurevmmicrosoftantimalwareextension?view=azuresmps-4.0.0

How to configure Microsoft Antimalware for Cloud Services:
https://docs.microsoft.com/powershell/module/servicemanagement/azure/set-azureserviceantimalwareextension?view=azuresmps-4.0.0

Understanding Microsoft Antimalware:
https://docs.microsoft.com/azure/security/fundamentals/antimalware

## 2.9: Enable DNS Query Logging

| Azure ID | CIS IDs | Responsibility |
|--|--|--|
| 2.9 | 8.7 | Customer |

Implement third party solution for dns logging.

## 2.10: Enable Command-line Audit Logging

| Azure ID | CIS IDs | Responsibility |
|--|--|--|
| 2.10 | 8.8 | Customer |

Customer to manually configure console logging and PowerShell Transcription on a per-node basis.

