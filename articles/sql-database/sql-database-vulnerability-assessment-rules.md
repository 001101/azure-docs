---
title: SQL Vulnerability Assessment rules reference guide
description: "List of rule titles and descriptions"
services: sql-database
ms.service: sql-database
ms.subservice: security
ms.topic: reference
author: VanMSFT
ms.author: vanto
ms.reviewer: vanto
ms.date: 04/06/2020
---

# SQL Vulnerability Assessment rules reference guide

This article lists the set of built-in rules that are used to flag security vulnerabilities and highlight deviations from best practices, such as misconfigurations, excessive permissions, and unprotected sensitive data. The rules are based on Microsoftâ€™s best practices and focus on the security issues that present the biggest risks to your database and its valuable data. They cover both database-level issues as well as server-level security issues, like server firewall settings and server-level permissions. These rules also represent many of the requirements from various regulatory bodies to meet their compliance standards.

The rules shown in your database scans depend on the SQL version and platform that was scanned. 

To learn about how to implement Vulnerability Assessment on SQL Databases see [Implement Vulnerability Assessment](https://docs.microsoft.com/azure/sql-database/sql-vulnerability-assessment#implementing-vulnerability-assessment).

## Rules

|Rule Id  |Rule Title  |Rule Category  |Rule Severity  |Rule Description  |Platform  |
|---------|---------|---------|---------|---------|---------|
| VA1017     |Execute permissions on xp_cmdshell from all users (except dbo) should be revoked         |AuthenticationAndAuthorization         |High         |The xp_cmdshell extended stored procedure spawns a Windows command shell         |</nobr>SQL Server 2012 </br>and above         |
| VA1018     |Latest updates should be installed         |InstallationUpdatesAndPatches         |High         |Microsoft periodically releases Cumulative Updates (CUs) for each version of SQL Server. This rule checks whether the latest CU has been installed for the particular version of SQL Server being used, by passing in a string for execution. This rule checks that all users (except dbo) do not have permission to execute the xp_cmdshell extended stored procedure. |</nobr>SQL Server 2005</br>SQL Server 2008</br><nobr>SQL Server 2008R2</nobr></br>SQL Server 2012</br>SQL Server 2014</br>SQL Server 2016</br>SQL Server 2017</br>|
|VA1020     |Database user GUEST should not be a member of any role         |AuthenticationAndAuthorization         |High         |The guest user permits access to a database for any logins that are not mapped to a specific database user. This rule checks that no database roles are assigned to the Guest user.         |<nobr/>SQL Server 2012 </br>and above         |
|VA1021     |Global temporary stored procedures should be removed         |DataProtection         |High         |A global temporary stored procedure is visible to all sessions and is dropped when the session of the user that created it is closed. This rule checks that there are no global stored procedures.         |<nobr/>SQL Server 2012 </br>and above         |
|Row5     |         |         |         |         |         |
|Row6     |         |         |         |         |         |
|Row7     |         |         |         |         |         |
|Row8     |         |         |         |         |         |
|Row9     |         |         |         |         |         |
|Row10     |         |         |         |         |         |
|Row11     |         |         |         |         |         |
|Row12     |         |         |         |         |         |
|Row13     |         |         |         |         |         |
|Row14     |         |         |         |         |         |
|Row15     |         |         |         |         |         |
|Row16     |         |         |         |         |         |
|Row17     |         |         |         |         |         |
|Row18     |         |         |         |         |         |
|Row19     |         |         |         |         |         |
|Row20     |         |         |         |         |         |
|Row21     |         |         |         |         |         |
|Row22     |         |         |         |         |         |
|Row23     |         |         |         |         |         |
|Row24     |         |         |         |         |         |
|Row25     |         |         |         |         |         |
|Row26     |         |         |         |         |         |
|Row27     |         |         |         |         |         |
|Row28     |         |         |         |         |         |
|Row29     |         |         |         |         |         |
|Row30     |         |         |         |         |         |
|Row31     |         |         |         |         |         |
|Row32     |         |         |         |         |         |
|Row33     |         |         |         |         |         |
|Row34     |         |         |         |         |         |
|Row35     |         |         |         |         |         |
|Row36     |         |         |         |         |         |
|Row37     |         |         |         |         |         |
|Row38     |         |         |         |         |         |
|Row39     |         |         |         |         |         |
|Row40     |         |         |         |         |         |
|Row41     |         |         |         |         |         |
|Row42     |         |         |         |         |         |
|Row43     |         |         |         |         |         |
|Row44     |         |         |         |         |         |
|Row45     |         |         |         |         |         |
|Row46     |         |         |         |         |         |
|Row47     |         |         |         |         |         |
|Row48     |         |         |         |         |         |
|Row49     |         |         |         |         |         |
|Row50     |         |         |         |         |         |
|Row10     |         |         |         |         |         |
|Row11     |         |         |         |         |         |
|Row12     |         |         |         |         |         |
|Row13     |         |         |         |         |         |
|Row14     |         |         |         |         |         |
|Row15     |         |         |         |         |         |
|Row16     |         |         |         |         |         |
|Row17     |         |         |         |         |         |
|Row18     |         |         |         |         |         |
|Row19     |         |         |         |         |         |
|Row20     |         |         |         |         |         |
|Row21     |         |         |         |         |         |
|Row22     |         |         |         |         |         |
|Row23     |         |         |         |         |         |
|Row24     |         |         |         |         |         |
|Row25     |         |         |         |         |         |
|Row26     |         |         |         |         |         |
|Row27     |         |         |         |         |         |
|Row28     |         |         |         |         |         |
|Row29     |         |         |         |         |         |
|Row30     |         |         |         |         |         |
|Row31     |         |         |         |         |         |
|Row32     |         |         |         |         |         |
|Row33     |         |         |         |         |         |
|Row34     |         |         |         |         |         |
|Row35     |         |         |         |         |         |
|Row36     |         |         |         |         |         |
|Row37     |         |         |         |         |         |
|Row38     |         |         |         |         |         |
|Row39     |         |         |         |         |         |
|Row40     |         |         |         |         |         |
|Row41     |         |         |         |         |         |
|Row42     |         |         |         |         |         |
|Row43     |         |         |         |         |         |
|Row44     |         |         |         |         |         |
|Row45     |         |         |         |         |         |
|Row46     |         |         |         |         |         |
|Row47     |         |         |         |         |         |
|Row48     |         |         |         |         |         |
|Row49     |         |         |         |         |         |
|Row50     |         |         |         |         |         |